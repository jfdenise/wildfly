<?xml version="1.0" ?>

<config xmlns="urn:jboss:galleon:config:1.0" name="standalone-ha.xml" model="standalone">
    <layers>
        <include name="jaxrs-server"/>
        <include name="ee-security"/>
        <include name="metrics"/>
        <include name="health"/>
        <exclude name="jpa"/>      
        <include name="jpa-distributed"/>            
                        
        <include name="h2-default-datasource"/>
        <!--<layer>elytron-oidc-client</layer>-->
                        
        <include name="ejb-http-invoker"/>
        <exclude name="ejb-local-cache"/>
        <include name="ejb-dist-cache"/>
        <include name="resource-adapters"/>
        <include name="remoting"/>
                        
        <include name="web-clustering"/>
        <include name="undertow-https"/>
        <include name="jdr"/>
        <include name="jsf"/>
        <include name="webservices"/>
        <include name="pojo"/>
        <include name="mail"/>
        <include name="sar"/>
        <include name="batch-jberet"/>
        <exclude name="messaging-activemq"/>
    </layers>

    <feature-group name="undertow-default-config"/>

    <!-- From ejb layer -->
    <feature spec="subsystem.naming">
        <feature spec="subsystem.naming.service.remote-naming"/>
    </feature>
    <feature spec="subsystem.ejb3">
        <feature spec="subsystem.ejb3.strict-max-bean-instance-pool">
            <param name="strict-max-bean-instance-pool" value="mdb-strict-max-pool"/>
            <param name="derive-size" value="from-cpu-count"/>
            <param name="timeout" value="5"/>
            <param name="timeout-unit" value="MINUTES"/>
        </feature>
        <feature spec="subsystem.ejb3.service.remote">
            <param name="connectors" value="[http-remoting-connector]"/>
            <param name="thread-pool-name" value="default"/>
            <feature spec="subsystem.ejb3.service.remote.channel-creation-options">
                <param name="channel-creation-options" value="MAX_OUTBOUND_MESSAGES"/>
                <param name="value" value="1234"/>
                <param name="type" value="remoting"/>
            </feature>
        </feature>
    </feature>

    <!-- the module it depends on is forced to be provisioned by galleon, so we are fine: WFLY-16099  -->
    <feature-group name="infinispan-dist-server"/>
    
    <!-- clustering not in layer -->
    <feature spec="subsystem.undertow.server">
        <param name="server" value="default-server"/>
        <feature spec="subsystem.undertow.server.ajp-listener">
            <param name="ajp-listener" value="ajp"/>
            <param name="socket-binding" value="ajp"/>
            <unset param="worker"/>
            <unset param="buffer-pool"/>
        </feature>
    </feature>
    <feature spec="socket-binding-group">
        <param name="socket-binding-group" value="standard-sockets" />
        <feature-group name="modcluster-sockets"/>
    </feature>
    <feature-group name="modcluster"/>
    <feature-group name="singleton"/>
</config>
